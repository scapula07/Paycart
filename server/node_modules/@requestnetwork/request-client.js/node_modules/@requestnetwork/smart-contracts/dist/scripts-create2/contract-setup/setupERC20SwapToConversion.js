"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.setupERC20SwapToConversion = void 0;
const tslib_1 = require("tslib");
const lib_1 = require("../../src/lib");
const adminTasks_1 = require("./adminTasks");
const currency_1 = require("@requestnetwork/currency");
/**
 * Updates the values of the chainlinkConversionPath and swap router of the ERC20SwapToConversion contract, if needed
 * @param contractAddress address of the ERC20SwapToConversion Proxy
 * @param hre Hardhat runtime environment
 */
const setupERC20SwapToConversion = (contractAddress, hre) => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
    // Setup contract parameters
    const ERC20SwapToConversionContract = new hre.ethers.Contract(contractAddress, lib_1.erc20SwapConversionArtifact.getContractAbi());
    yield Promise.all(hre.config.xdeploy.networks.map((network) => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
        try {
            currency_1.EvmChains.assertChainSupported(network);
            const { signer, txOverrides } = yield (0, adminTasks_1.getSignerAndGasFees)(network, hre);
            const ERC20SwapToConversionConnected = yield ERC20SwapToConversionContract.connect(signer);
            yield (0, adminTasks_1.updateChainlinkConversionPath)(ERC20SwapToConversionConnected, network, txOverrides);
            yield (0, adminTasks_1.updateSwapRouter)(ERC20SwapToConversionConnected, network, txOverrides);
            yield (0, adminTasks_1.updateRequestSwapFees)(ERC20SwapToConversionConnected, txOverrides);
            console.log(`Setup of Erc20SwapToConversion successful on ${network}`);
        }
        catch (err) {
            console.warn(`An error occurred during the setup of Erc20SwapToConversion on ${network}`);
            console.warn(err);
        }
    })));
});
exports.setupERC20SwapToConversion = setupERC20SwapToConversion;
//# sourceMappingURL=setupERC20SwapToConversion.js.map